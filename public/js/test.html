<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login with Facebook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .comment__operate {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f5f5f5;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .comment__operate__icon {
            font-size: 24px;
            color: #4267B2;
            margin-right: 10px;
        }

        .comment__operate span {
            margin: 0;
            font-size: 16px;
            color: #333;
        }

        .comment__operate:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="comment__operate" id="fb-login-btn">
        <i class="comment__operate__icon fab fa-facebook"></i>
        <span>Đăng nhập bằng Facebook</span>
    </div>

    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
    <script>
        window.fbAsyncInit = function() {
            FB.init({
                appId      : '849025356764898',
                cookie     : true,
                xfbml      : true,
                version    : 'v15.0'
            });

            FB.AppEvents.logPageView();

            document.getElementById('fb-login-btn').onclick = function() {
                FB.login(function(response) {
                    if (response.status === 'connected') {
                        // Người dùng đã đăng nhập thành công
                        var accessToken = response.authResponse.accessToken;
                        console.log('Access Token:', accessToken);

                        // Gọi API Facebook để lấy thông tin người dùng
                        FB.api('/me', {fields: 'name,email,picture'}, function(response) {
                            console.log('Successful login for: ' + response.name);
                            console.log('Email: ' + response.email);
                            console.log('Profile picture: ' + response.picture.data.url);
                            
                            // Gửi thông tin người dùng đến server để xử lý đăng nhập
                            fetch('/your-backend-endpoint', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    name: response.name,
                                    email: response.email,
                                    picture: response.picture.data.url,
                                    accessToken: accessToken
                                })
                            }).then(res => res.json()).then(data => {
                                console.log('Server response:', data);
                                // Xử lý dữ liệu từ server, ví dụ: chuyển hướng, lưu thông tin người dùng, vv.
                            }).catch(error => console.error('Error:', error));
                        });
                    } else {
                        console.log('User cancelled login or did not fully authorize.');
                    }
                }, {scope: 'public_profile,email'});
            };
        };

        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
</body>
</html>
